(window.webpackJsonp=window.webpackJsonp||[]).push([["add-compare-dialog"],{FxnJ:function(t,e,o){},NhD9:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.createTabbedDialog=function(e){e=$.extend({},i,e);var o=$(t.render('<div class="tv-dialog__section tv-dialog__section--title tv-tabbed-dialog__header js-close-button-place" tabindex="-1"><div class="tv-tabs tv-tabbed-dialog__tabs js-dialog__drag">{{#tabs}}<div class="tv-tabs__tab">{{name}}</div>{{/tabs}}</div>{{#customControls}}<div class="js-custom-controls tv-tabbed-dialog__custom-controls {{#customControlsAddClass}}{{customControlsAddClass}}{{/customControlsAddClass}}"></div>{{/customControls}}<div class="tv-tabbed-dialog__bottom-border"></div></div>{{>additionalHeaderContent}}',{tabs:e.tabs,customControls:e.customControls,customControlsAddClass:e.customControlsContainerAddClass},{additionalHeaderContent:e.additionalHeaderContent})),s=$('<div class="tv-tabbed-dialog__pages-container"></div>'),l=s;e.contentAddClass&&s.addClass(e.contentAddClass);!1!==e.withScroll&&(s=$('<div class="js-dialog__scroll-wrap tv-dialog__scroll-wrap">').append(l.addClass("tv-dialog__scroll-wrap-inner")));var c=$('<div class="tv-tabbed-dialog">').append(o).append(s);e.customControls&&o.find(".js-custom-controls").append(e.customControls);if(!0!==e.doNotCreatePages)for(var r=0;r<e.tabs.length;++r)l.append($('<div class="tv-tabbed-dialog__tab-page">').append(e.tabs[r].page));var d=e.tabStateSaveKey,u=e.activeTab,b=e.tabsScrollBoxAddClass,p=e.tabAddClass;delete e.tabs,delete e.activeTab,delete e.customControls,delete e.tabStateSaveKey,delete e.customControlsContainerAddClass,delete e.tabsScrollBoxAddClass,delete e.tabAddClass,e.closeButtonAddClass="tv-tabbed-dialog__close",e.contentWrapTemplate=c;var h=(0,n.createDialog)(e),f=new a.Tabs(o.find(".tv-tabs").get(0),l.get(0),{addLeftArrowsClass:"tv-tabbed-dialog__tabs-arrow-left",addRightArrowsClass:"tv-tabbed-dialog__tabs-arrow-right",addScrollBoxClass:b,tabClass:p,saveTab:d,activeTab:u});return h.on("afterOpen",(function(){f.setActivePage(f.index(),!0,!0)})),{dialog:h,tabs:f}};var a=o("pIOw"),n=o("YDhE");o("FxnJ");var i={tabs:[]}}).call(this,o("nbsC"))},UnpO:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSymbolTab=void 0;var a=function(){function t(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}(),n=o("dKfe"),i=o("pZll");o("UxRG"),o("k47Q");var s='\n\t<div class="tv-add-symbol-tab">\n\t\t<input type="text" class="tv-control-input js-add-symbol-tab-input" placeholder="'+$.t("Symbol")+'" autocomplete="off">\n\t\t<div class="tv-add-symbol-tab__add-symbol-overlay js-add-symbol-tab-checkbox"></div>\n\t</div>';e.AddSymbolTab=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._chartWidgetCollection=e,this._dialog=o,
this._$popup=null,this.init()}return a(t,[{key:"init",value:function(){var t=this;this.$tab=$(s),this._$input=this.$tab.find(".js-add-symbol-tab-input"),this._checkbox=new n.AddSymbolCheckbox({labelRight:$.t("Overlay the main chart"),labelAddClass:"tv-add-symbol-tab__checkbox-label",boxAddClass:"tv-add-symbol-tab__checkbox-box"}),this.$tab.find(".js-add-symbol-tab-checkbox").append(this._checkbox.$el),(0,i.symbolSearchUIService)().bindToInput(this._$input,{callback:function(e){var o=t._chartWidgetCollection.activeChartWidget.value();o&&o.addOverlayStudy(e,t._checkbox.checked)},onPopupOpen:function(e){e.css("z-index",t._dialog.getZIndex()),t._$popup=e},onPopupClose:function(){t._$popup=null},keepFocus:!0,clearAfterAccept:!0})}},{key:"focus",value:function(){Modernizr.mobiletouch||this._$input.focus()}},{key:"isClickOnTab",value:function(t){return!!this._$popup&&!(this._$popup[0]!==t.target&&!this._$popup[0].contains(t.target))}}]),t}()},UxRG:function(t,e,o){},dKfe:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddSymbolCheckbox=void 0;var a,n=o("QwKQ"),i=(a=n)&&a.__esModule?a:{default:a};e.AddSymbolCheckbox=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.checked=TVSettings.getBool("showAddSymbolDialog.checkboxState",!0);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.$checkbox.change((function(){setTimeout((function(){TVSettings.setValue("showAddSymbolDialog.checkboxState",o.checked)}))})),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(i.default)},frtK:function(t,e,o){},jPTo:function(t,e,o){},k47Q:function(t,e,o){},ocUP:function(t,e,o){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.CompareTab=void 0;var n=function(){function t(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}(),i=o("pZll"),s=o("JWMC");o("UxRG"),o("b6p+"),o("frtK")
;var l='\n\t<div class="tv-compare-tab">\n\t\t<input type="text" class="tv-control-input js-compare-tab-input" placeholder="'+$.t("Company Comparison")+'" autocomplete="off">\n\t</div>',c='\n\t<div class="tv-compare-tab__predefine-cell {{additionalClass}}">\n\t\t<label for="{{symbolId}}">\n\t\t\t<span class="tv-control-checkbox">\n\t\t\t\t<input class="tv-control-checkbox__input js-predefine-checkbox" type="checkbox" id="{{symbolId}}">\n\t\t\t<span class="tv-control-checkbox__box tv-compare-tab__checkbox-box">'+o("aLUT")+'</span>\n\t\t\t<span class="tv-control-checkbox__ripple js-ripple"></span>\n\t\t\t</span>\n\t\t\t<span class="tv-control-checkbox__label tv-compare-tab__checkbox-label">{{label}}</span>\n\t\t</label>\n\t</div>';e.CompareTab=function(){function e(o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectedSymbols=[],this._chartWidgetCollection=o,this._dialog=a,this._$popup=null,this._predefines={},this._symbolAlias={},this._isBovespa=t.enabled("bovespa_widget"),this._predefines=this._chartWidgetCollection.activeChartWidget.value().compareSymbols()||[],this.init()}return n(e,[{key:"_addCompareSymbol",value:function(t,e,o){var a=this._chartWidgetCollection.activeChartWidget.value();if(a)return this.selectedSymbols.push(t),a.addCompareStudy(t).then((function(t){var e=null!==t;return e&&(0,s.trackEvent)("GUI","Add Compare"),e}))}},{key:"removeCompareSymbol",value:function(t){var e=this,o=this._chartWidgetCollection.activeChartWidget.value();if(o){var a=o.model();a&&(this.selectedSymbols=this.selectedSymbols.filter((function(e){return e!==t})),a.dataSources().forEach((function(o){if(o._metaInfo&&"Compare@tv-basicstudies"===o._metaInfo.id){var n=o.properties().inputs.symbol.value();(n===t||e._symbolAlias[n]&&e._symbolAlias[n]===t)&&a.removeSource(o)}})))}}},{key:"init",value:function(){var t=this,e=this._chartWidgetCollection.activeChartWidget.value();if(e){var o=e.model();if(o){var a=o.dataSources();this.$tab=$(l),this._initSymbolSearch(),this._createPredefinesList();var n=this.$tab.find(".js-compare-tab-predefines");n.find(".js-predefine-checkbox").attr("checked",!1),this._predefines.forEach((function(e){var o=e.symbol,i=t._symbolToId(o),s=n.find("#"+i);a.forEach((function(e){if(e._metaInfo&&"Compare@tv-basicstudies"===e._metaInfo.id){var a=e.properties().inputs.symbol.value();(a===o||t._symbolAlias[a]&&t._symbolAlias[a]===o)&&(s.attr("checked",!0),t.selectedSymbols.push(a))}}))}))}}}},{key:"_initSymbolSearch",value:function(){var t=this;this._$input=this.$tab.find(".js-compare-tab-input"),(0,i.symbolSearchUIService)().bindToInput(this._$input,{callback:function(e){return t._addCompareSymbol(e)},onPopupOpen:function(e){e.css("z-index",t._dialog.getZIndex()),t._$popup=e},onPopupClose:function(){t._$popup=null},keepFocus:!0,clearAfterAccept:!0})}},{key:"_createPredefinesList",value:function(){var t=this,e=this;function o(t){var o=this;setTimeout((function(){$(o).is(":checked")?e._addCompareSymbol(t.data.symbol).then((function(t){
t||$(o).attr("checked",!1)})):e.removeCompareSymbol(t.data.symbol)}))}var n=$('<div class="tv-compare-tab__predefines js-compare-tab-predefines"></div>');this._predefines.forEach((function(e){var i=e.symbol,s=e.title,l=$(a.render(c,{symbolId:t._symbolToId(i),label:s,additionalClass:t._isBovespa?"tv-compare-tab__predefine-cell--wide":""}));l.find(".js-predefine-checkbox").change({symbol:i},o),l.appendTo(n)})),n.appendTo(this.$tab)}},{key:"_symbolToId",value:function(t){return t.replace(/[^a-z0-9]/gi,"_")}},{key:"focus",value:function(){Modernizr.mobiletouch||this._$input.focus()}},{key:"isClickOnTab",value:function(t){return!!this._$popup&&!(this._$popup[0]!==t.target&&!this._$popup[0].contains(t.target))}}]),e}()}).call(this,o("Kxc7"),o("nbsC"))},tkV1:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddCompareDialog=void 0;var a=function(){function t(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}(),n=o("ocUP"),i=o("UnpO"),s=o("NhD9"),l=o("JWMC");o("jPTo");e.AddCompareDialog=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._chartWidgetCollection=e,this._$symbolSearchPopup=null,this._dialog=null}return a(t,[{key:"show",value:function(){if(this.isOpened())return this._dialog;null!==this._dialog&&this._dialog.destroy();var t=new n.CompareTab(this._chartWidgetCollection,this),e=new i.AddSymbolTab(this._chartWidgetCollection,this),o=[];o.push({name:$.t("Compare"),page:t.$tab.addClass("tv-compare-dialog__tab-page")}),o.push({name:$.t("Add Symbol",{context:"compare_or_add_symbol_dialog"}),page:e.$tab.addClass("tv-compare-dialog__tab-page")});var a=(0,s.createTabbedDialog)({tabs:o,width:400,tabStateSaveKey:"CompareAddDialog.tab",destroyOnClose:!0,withScroll:!1,addClass:"tv-compare-dialog",tabsScrollBoxAddClass:"tv-compare-dialog__scroll-box",tabAddClass:"tv-compare-dialog__tab",isClickOutFn:function(o){if(t.isClickOnTab(o)||e.isClickOnTab(o))return!1}});return this._dialog=a.dialog,this._dialog.on("afterClose",(function(){(0,l.trackEvent)("GUI","Compare",t.selectedSymbols.sort().join(", "))})),this._dialog.open(),this._dialog}},{key:"hide",value:function(){this.isOpened()&&this._dialog.close()}},{key:"isOpened",value:function(){return this._dialog&&this._dialog.isOpened()}},{key:"getZIndex",value:function(){return this._dialog.zIndex}}]),t}()}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["widgetbar"],{"1Pr8":function(t,e,i){t.exports={button:"button-3SuA46Ww",hover:"hover-3AIQmXGb",hoverMask:"hoverMask-LMMGveQV",icon:"icon-ogPAaQZH",counterRow:"counterRow-S6Ya-jCg",counter:"counter-1TX_xqdT",isGrayed:"isGrayed-3O5VgbN4",isActive:"isActive-1D4aU96I",isTab:"isTab-1dbyVeUX"}},"1WEt":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m18 18v-.5c0-1.2.6-2 1.5-2.7.8-.5 2-.8 3-.8s2.2.3 3 .8c.9.6 1.5 1.5 1.5 2.7a4 4 0 0 1-1.3 2.8l-2.3 2c-.3.3-.4.6-.4 1.2v.5h-1v-.5c0-.8.2-1.4.6-1.9l2.4-2c.6-.7 1-1.3 1-2.1a2 2 0 0 0-1-1.8c-.7-.5-1.6-.7-2.5-.7-1 0-1.8.2-2.5.7-.6.4-1 1-1 1.8v.5m3.5 8a1 1 0 0 0 0 5 1 1 0 0 0 0-5m0 1a1 1 0 0 1 0 3 1 1 0 0 1 0-3m0-17a1 1 0 0 0 0 25 1 1 0 0 0 0-25m0 1a1 1 0 0 1 0 23 1 1 0 0 1 0-23"/></svg>'},"5qsH":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><g fill="none" stroke="currentColor"><path d="M14.5 27.5c0 4.97 3.03 8 8 8 4.97 0 8-3.03 8-8v-6a3 3 0 0 0-3-3h-10a3 3 0 0 0-3 3v6z"/><path stroke-linecap="square" d="M22.5 19v16"/><path d="M27.5 18.5a5 5 0 1 0-10 0m13 3h2a2 2 0 0 1 2 2V25m-4 2.5h2a2 2 0 0 1 2 2V31M29 32.5h1.5a2 2 0 0 1 2 2V36m-18-14.5h-2a2 2 0 0 0-2 2V25m4 2.5h-2a2 2 0 0 0-2 2V31m5.5 1.5h-1.5a2 2 0 0 0-2 2V36"/><g transform="translate(12 8)"><circle cx="2.5" cy="2.5" r="2"/><path d="M3.911 3.911L7 7"/></g><g transform="translate(26 8)"><circle cx="4.5" cy="2.5" r="2"/><path d="M3.115 3.885L0 7"/></g></g></svg>'},"9Qhg":function(t,e,i){},BH4H:function(t,e,i){"use strict";(function(e,a,n){i("9Qhg"),i("TdlR");var s=i("Eyy1").ensureNotNull,o=i("PiKd"),r=i("Q8Ag"),d=i("PT1i").linking,l=i("1AAW").combine,h=i("JWMC").trackEvent,g=i("e3/o"),c=i("/BH3"),u=i("TSYQ"),p=i("Fb/L").WidgetBarInternal,w=i("dkCg").RightToolbarRenderer,v=i("tBUM").WidgetBarTabButtonViewModel,f=i("jkvV").Hider,m=i("i8i4"),y=i("q1tI"),b=i("HySD"),_=i("N22A"),B=_.tradingService,C=_.waitTradingService,P=i("b5Gw").makeCancelable,T=i("ULlu").unwrap;i("e9Yb");var W=i("xrkQ"),S=parseInt(W["css-value-widgets-margin"]);const x={title:$.t("Details"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,widgetClass:W.widget,headerClass:W.widgetHeader,margin:S},z=Object.assign({},x,{noHeaderSpace:!0,titleClass:W.widgetTitle});function M(t){t||(t={}),this.options=t,this.resizerBridge=t.resizerBridge,this.adaptive=!!t.adaptive,this.tradingPanelAccessor=t.tradingPanelAccessor;var e=this.resizerBridge;this._visible=l((function(t,e,i){return Boolean(t&&e&&i)}),e.width,e.height,e.visible),this.widgetConfig=$.extend(!0,{},M.widgetConfig),t.widgetConfig&&(this.widgetConfig=$.extend(!0,this.widgetConfig,t.widgetConfig)),this.layout=new O({widgetBar:this}),this._customization=t.customization,t.chartWidgetCollection&&(this.chartWidgetCollection=t.chartWidgetCollection),t.state?this.layout.demarshal(t.state):t.settingsPrefix&&(this._settingsPrefix=t.settingsPrefix+"",this.loadFromTVSettings()),t.readonly&&(this.readonly=!0),t.fixedMode&&(this.fixedMode=!0),
t.showCloseButton&&(this.showCloseButton=!0),this.$container=$(this.resizerBridge.container.value()),this._internal=new p(this),this.createHTML(),this.initLayout(),loginStateChange.subscribe(this,this.onLoginStateChange),this.resizerBridge.width.subscribe(function(){this.layout.syncWidth()}.bind(this)),this.resizerBridge.height.subscribe(function(){this.layout.syncHeight()}.bind(this)),this.resizerBridge.visible.subscribe(function(t){this.layout.onVisibilityChange(t)}.bind(this)),this.resizerBridge.availWidth.subscribe(function(){this.layout.requestOptimalWidth(),this.layout.updateResponsiveness()}.bind(this)),this._tradingServiceCancelable=P(C()),this._tradingServiceCancelable.promise.then(function(t){this._tradingServiceCancelable=null,t.onConnectionStatusChange.subscribe(this,this._onBrokerConnectionStatusChanged)}.bind(this))}M.widgetConfig={reuters_calendar:{title:$.t("Economic Calendar"),ctor:null,lazyLoad:!0,icon:"economic-calendar",options:{widgetType:"widgetbar"}},earnings_calendar:{title:$.t("Earnings Calendar"),ctor:null,lazyLoad:!0,icon:"earnings-calendar"},watchlist:{title:$.t("Watchlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:W.widget,headerClass:W.widgetHeader,margin:S,preloadDelay:6e4},hotlist:{title:$.t("Hotlist"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,widgetClass:W.widget,headerClass:W.widgetHeader,margin:S},detail:z,news:{title:$.t("Headlines"),ctor:null,noHeaderSpace:!0,widgetClass:W.widget,headerClass:W.widgetHeader,titleClass:W.widgetTitle,margin:S},chat:{title:$.t("Talks"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0},messages_with_select:{title:$.t("Recent Chats"),ctor:null,chartWidgetAllowed:!0,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notifications_user:{title:$.t("Notifications"),ctor:null,options:{type:"user"},chartWidgetAllowed:!0},notifications_following:{title:$.t("Ideas Stream"),ctor:null,options:{type:"following"},chartWidgetAllowed:!0},datawindow:{title:$.t("Data Window"),ctor:null,chartWidgetAllowed:!0,chartWidgetRequired:!0},publicchats:{title:$.t("All Talks"),ctor:null,doNotClearNotifications:!0},publicchats_with_select:{title:$.t("All Talks"),ctor:null,doNotClearNotifications:!0,options:{layoutWithSelect:!0},emptyHeader:!0},notes:{title:$.t("My Ideas"),ctor:null,lazyLoad:!0,chartWidgetAllowed:!0},alerts_manage:{ctor:null,lazyLoad:!0,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:W.widget,headerClass:W.widgetHeader,margin:S},alerts_log:{ctor:null,chartWidgetAllowed:!0,emptyHeader:!0,noHeaderSpace:!0,widgetClass:W.widget,headerClass:W.widgetHeader,margin:S},market_summary:{title:$.t("Market Summary"),ctor:null},object_tree:{title:$.t("New Object tree. Multi-select drawings tools"),ctor:null,noHeader:!0,chartWidgetAllowed:!0,chartWidgetRequired:!0}},M.svgIcons={base:i("dECE")},M.svgIcons["object-tree"]=i("aE/C"),M.svgIcons.datawindow=i("GNw3"),M._messageHandlers=[],
M.postMessage=function(t,e){M._messageHandlers.forEach((function(i){i.handler(t,e)}))},M.onMessage=function(t){"function"==typeof t&&M._messageHandlers.push({handler:t,widget:this})},M.prototype.destroy=function(){null!==this._tradingServiceCancelable?(this._tradingServiceCancelable.cancel(),this._tradingServiceCancelable=null):s(B()).onConnectionStatusChange.unsubscribe(this,this._onBrokerConnectionStatusChanged);this._internal.destroy(),this._internal=null},M.prototype.isVisible=function(){var t=this.resizerBridge;return t.visible.value()&&t.height.value()&&t.width.value()},M.prototype.visible=function(){return this._visible},M.prototype.initLayout=function(){var t=this;o.load("widgetbar",(function(){var e=$.Deferred();return r.loadWidgetBarModules((function(i){var a=t.widgetConfig;a.reuters_calendar.ctor=i.ReutersCalendarWidget,a.earnings_calendar.ctor=i.CalendarWidget&&i.CalendarWidget.Earnings,a.watchlist.ctor=i.Watchlist,a.hotlist.ctor=i.HotlistWidget,a.detail.ctor=i.Detail&&i.Detail.Widget,a.news.ctor=i.NewsWidget,a.chat.ctor=i.ChatWidget,a.messages.ctor=i.Messages&&i.Messages.Widget,a.messages_with_select.ctor=i.Messages&&i.Messages.Widget,a.notifications_following.ctor=i.NotificationsWidgets,a.notifications_user.ctor=i.NotificationsWidgets,a.publicchats.ctor=i.PublicChatsWidget,a.publicchats_with_select.ctor=i.PublicChatsWidget,a.notes.ctor=i.NotesWidget,a.alerts_manage.ctor=i.AlertsManageWidget,a.alerts_log.ctor=i.AlertsLogWidget,e.resolve(i)})),e.promise()}),this.options.instantLoad),o.onReady("widgetbar",(function(){t.layout.startWidgets()})),0===this.layout.pages.length&&(this.layout.setMinimizedState(!0),this.layout.$handle.addClass("js-hidden")),t.layout.requestOptimalWidth(),this.layout.syncWidth(),this.layout.syncHeight(),t.layout.onVisibilityChange(),t.layout.updateResponsiveness()},M.prototype.loadWidgets=function(){this._widgetsLoadRequested||(this._widgetsLoadRequested=!0,o.load("widgetbar",null,!0))},M.prototype.onLoginStateChange=function(t){t||window.is_authenticated&&(this.dropWidgetData(),this.refreshFromTVSettings())},M.prototype.dropWidgetData=function(){for(var t in this.widgetConfig)delete this.widgetConfig[t].data},M.prototype.refreshFromTVSettings=function(){this._settingsPrefix&&(this.layout&&this.layout.destroy(),this.layout=new O({widgetBar:this}),this.loadFromTVSettings(),this.layout.createHTML(),this.layout.$pages.appendTo(this.$wrap),this.layout.$tabs.appendTo(this.$wrap),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap),this.initLayout())},M.prototype.getWidgets=function(t){for(var e=[],i=0;i<this.layout.pages.length;++i)e=e.concat(this.layout.pages[i].getWidgets(t));return e},M.prototype.loadFromTVSettings=function(){if(this._settingsPrefix){try{this.migrateFromOld()}catch(s){console.error&&console.error(s)}var t=this.getLayoutState();t=this.mergeProperties(t),this.layout.demarshal(t,{settingsPrefix:this._settingsPrefix}),this.saveToTVSettings();var e=TVSettings.getJSON(this._settingsPrefix+"."+c.layoutKeyName,null);if(e){var i,a=[]
;for(i in e.widgets)a=a.concat(e.widgets[i].map((function(t){return t.id})));var n=TVSettings.keysMask(this._settingsPrefix+".widget.*.*");n&&n.forEach(function(t){var e=t.replace(this._settingsPrefix+".widget.","");-1===a.indexOf(e)&&0===t.indexOf(this._settingsPrefix+".widget.")&&(h("Settings debug","loadFromTVSettings: "+t,user.username),TVSettings.remove(t))}.bind(this))}}},M.prototype.mergeProperties=function(t){var e=TVSettings.getJSON(this._settingsPrefix+"."+c.layoutKeyName,null);if(!e)return t;e.settings&&$.extend(t,e.settings);for(var i={},a=0;a<t.pages.length;a++)for(var n=0;n<t.pages[a].widgets.length;n++){var s=t.pages[a].widgets[n],o=i[s.type]||0;e.widgets[s.type]&&e.widgets[s.type][o]&&$.extend(s,e.widgets[s.type][o]),i[s.type]=++o}return t},M.prototype.migrateFromOld=function(t){var e=TVSettings.getJSON(this._settingsPrefix+".layout-fixed",null);if(e){var i={settings:{}};"minimized"in e&&(i.settings.minimized=e.minimized),"width"in e&&(i.settings.width=e.width),"activeIndex"in e&&(i.settings.activeIndex=e.activeIndex),i.widgets={};for(var a=0;a<e.pages.length;a++)for(var n=e.pages[a].widgets||e.pages[a],s=0;s<n.length;s++){var o,r=n[s];r.id?(o=r.id.replace(/\..*/,""),/^news_.+/.test(o)&&(o=r.type="news",TVSettings.setJSON(this._settingsPrefix+".widget."+r.id.replace(/news_[^.]*/,"news"),TVSettings.getValue(this._settingsPrefix+".widget."+r.id)),r.id=r.id.replace(/news_[^.]*/,"news"))):(o=r.type,/^news_.+/.test(o)&&(r.properties=r.properties||{},r.properties.provider=r.type.replace(/news_([^.]*).*/,"$1"),o=r.type="news")),i.widgets[o]?i.widgets[o].push(r):i.widgets[o]=[r]}TVSettings.setJSON(this._settingsPrefix+"."+c.layoutKeyName,i)}else if(TVSettings.getJSON(this._settingsPrefix+".layout",null)){var d=this.getWidgetProperties("watchlist");if(d){i={settings:{},widgets:{watchlist:[d]}};TVSettings.setJSON(this._settingsPrefix+"."+c.layoutKeyName,i)}}e&&TVSettings.remove(this._settingsPrefix+".layout-fixed"),TVSettings.getJSON(this._settingsPrefix+".layout",null)&&TVSettings.remove(this._settingsPrefix+".layout")},M.prototype.saveToTVSettings=function(){if(this._settingsPrefix){var t=this.layout.marshal();TVSettings.setJSON(this._settingsPrefix+"."+c.layoutKeyName,t)}},M.prototype.getWidgetProperties=function(t,e){e=e||0;var i=this._settingsPrefix.replace(/\W/g,"\\$&")+".widget.",a=TVSettings.keysMask(i+t+".*");return!!(a&&a.length&&(a=a.sort())[e])&&{id:a[e].replace(i,"")}},M.prototype._onBrokerConnectionStatusChanged=function(t){0};var A={type:"news"};function O(t){this.widgetBar=t.widgetBar,this.pages=[],this.activePageIndex=new a(this.activeIndex),this.isMinimized=new a(this.minimized),t&&t.widgetBar&&Object.defineProperty(this,"widgetBar",{value:t.widgetBar,configurable:!0})}function E(t){this.widgets=[],t&&t.widgetBarLayout&&Object.defineProperty(this,"widgetBarLayout",{value:t.widgetBarLayout,configurable:!0})}function V(t){t&&t.widgetBarPage&&Object.defineProperty(this,"widgetBarPage",{value:t.widgetBarPage,configurable:!0}),this._internalState={alive:new a(!0),container:new a,width:new a,
height:new a,detachable:new a(!1)},this._rdState=new b.ResizerDetacherState(this._internalState),this._rdState.owner.subscribe(function(t){t!==this._internalState&&$(this._internalState.container.value()).empty()}.bind(this)),this.widgetActive=new a,this.widgetMaximized=new a,this._widgetStarted=new n,this._preloadTimeout=null}function H(t){t&&t.settingsKey&&(this._settingsKey=t.settingsKey,this._value=TVSettings.getJSON(this._settingsKey,null)),t&&t.widgetBarWidget&&Object.defineProperty(this,"widgetBarWidget",{value:t.widgetBarWidget,configurable:!0})}function L(){return e.enabled("right_toolbar")}M.prototype.getGenericLayoutState=function(t){var i=c.getDefaultState(),a=window.COUNTRY_CODE_TO_DEFAULT_EXCHANGE;a.default=a.en;for(var n=[{_gaEvent:"General Widget",title:$.t("Watchlist, details and news"),name:"base",icon:"base",widgets:[{type:"watchlist",properties:t&&t.length?{list:t}:void 0},{type:"detail"},Object.assign({},A,{isEnabled:!0})]},e.enabled("alerts")?{_gaEvent:"Alerts",title:$.t("Alerts"),name:"alerts",icon:"alarm-clock",widgets:[{type:"alerts_manage",properties:{}},{type:"alerts_log",properties:{}}]}:null,null,null,{_gaEvent:"Data Window",title:$.t("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]},{_gaEvent:"Hotlists",title:$.t("Hotlists"),name:"hotlist",icon:"hotlists",widgets:[{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"volume_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"percent_change_gainers"}}},{type:"hotlist",properties:{exchangeByLocale:a,groupByLocale:{default:"percent_change_loosers"}}}]},{_gaEvent:"Calendar",title:$.t("Calendar"),name:"calendar",icon:"calendar",widgets:[{type:"reuters_calendar",properties:{}},{type:"earnings_calendar",properties:{}}]},{_gaEvent:"My Ideas",title:$.t("My Ideas"),name:"notes",icon:"notes",spaceBottom:!0,spaceBottomText:$.t("Social"),widgets:[{type:"notes"}]},{_gaEvent:"Public Chats",title:$.t("Public Chats"),name:"chats",icon:"chat",widgets:[{type:"chat"},{type:"publicchats"}]},{_gaEvent:"Private Chats",title:$.t("Private Chats"),name:"pm_chats",icon:"messages",widgets:[{type:"messages"}]},{_gaEvent:"Ideas Stream",title:$.t("Ideas Stream"),name:"ideas_stream",icon:"ideas-stream",widgets:[{type:"notifications_following"}]},{_gaEvent:"Notifications",title:$.t("Notifications"),name:"notifications",icon:"notifications",widgets:[{type:"notifications_user"}]}],s=0;s<n.length;s++)n[s]&&i.pages.push(n[s]);return i},M.prototype.getChartingPlatformLayoutState=function(t,i){var a={version:2,width:267,pages:[]};if(this._customization.watchlist||this._customization.details||this._customization.news){var n="",s=[];this._customization.watchlist&&(n=$.t("Watchlist"),s.push({type:"watchlist",id:"watchlist."+i,properties:t&&t.length?{list:t}:void 0})),this._customization.details&&(this._customization.watchlist?n+=" "+$.t("and details"):n=$.t("Details"),s.push({type:"detail"})),
this._customization.news&&(this._customization.watchlist||this._customization.details?n+=" and news":n="News",s.push({type:"news",id:"news."+i})),a.pages.push({name:"base",title:n,icon:"base",widgets:s})}return this._customization.datawindow&&a.pages.push({title:$.t("Data Window"),name:"data-window",icon:"datawindow",widgets:[{type:"datawindow"}]}),e.enabled("show_object_tree")&&this.chartWidgetCollection&&!this.chartWidgetCollection.readOnly()&&a.pages.push({title:$.t("Show Object tree"),name:"object_tree",icon:"object-tree",onBottom:!1,widgets:[{type:"object_tree"}]}),a},M.prototype.getLayoutState=function(){var t,i=this,a=TVSettings.getJSON("watchlist.list",[]);function n(t){return!(void 0!==t.isEnabled&&!t.isEnabled)&&(i.chartWidgetCollection||!M.widgetConfig[t.type].chartWidgetRequired)}for(var s=(t=e.enabled("cqg_terminal")?this.getChartingPlatformLayoutState(a,"cqg"):e.enabled("trading_terminal")?this.getChartingPlatformLayoutState(a,"terminal"):this.getGenericLayoutState(a)).pages.length-1;s>=0;s--){var o=t.pages[s];o.widgets=$.grep(o.widgets,n)}return t.pages=$.grep(t.pages,(function(t){return t.widgets&&t.widgets.length})),t},M.prototype.createWidgetId=function(t){return t+"."+g.randomHash()},M.prototype.setPage=function(t){this.layout.setMinimizedState(!1);var e=this.layout.activeIndex;return this.layout.pages.forEach((function(i,a){i.name===t&&(e=a)})),this.layout.switchPage(e),this.layout.getActivePage()},O.prototype.startWidgets=function(){this.pages.forEach((function(t){t.widgets.forEach((function(t){t.widgetObject||t.widgetStartDelayed||setTimeout((function(){t.startWidget()}),0)}))}));var t=this.getActivePage();t&&t.onActiveStateChange(!0)},O.prototype.syncHeight=function(){var t=this.widgetBar.resizerBridge.height.value();if(this.$pages.css("height",t+"px"),!this.minimized){var e=this.getActivePage();e&&e.updateWidgetsHeight()}},O.prototype.tabsWidth=function(){return L()?c.tabsWidth:this.minimized?c.hiderGapWidth:0},O.prototype.borderWidth=function(){return c.borderWidth},O.prototype.canOpen=function(){return this.MIN_WIDTH+this.tabsWidth()+this.borderWidth()<=this.widgetBar.resizerBridge.availWidth.value()},O.prototype.requestWidth=function(t){var e=this.widgetBar.resizerBridge;t>0&&(t+=this.borderWidth());var i=this.tabsWidth(),a=t+i;this.canOpen()?e.width.value()!==a&&e.negotiateWidth([{min:i,max:i},{min:this.MIN_WIDTH+i,max:a}]):e.negotiateWidth(0)},O.prototype.requestOptimalWidth=function(){this.changeWidgetsButtonTitle(),this.minimized?this.requestWidth(0):this.requestWidth(this.width)},O.prototype.updateResponsiveness=function(){var t=!this.canOpen();this.$tabs.toggleClass("js-hidden",t),this.$pages.toggleClass("js-hidden",t)},O.prototype.syncWidth=function(){var t=this.widgetBar.resizerBridge,e=this.tabsWidth(),i=this.borderWidth(),a=t.width.value(),n=Math.max(a-e-i,0)||0;if(n<this.MINIMIZE_THRESHOLD?this.setMinimizedState(!0):this.setMinimizedState(!1),this.$pages.css("width",n+"px").toggleClass("hidden",!!this.minimized),!this.minimized){var s=this.getActivePage()
;s&&s.widgets.forEach((function(t){t.onWidthChange(n)})),this.widgetBar&&this.widgetBar.loadWidgets()}var o=!this.canOpen();this.$deviceButton&&this.$deviceButton.toggleClass("js-hidden",!o||!this.minimized)},O.prototype.setMinimizedState=function(t){t=!!t,!!this.minimized!==t&&(this.minimized=t,this.isMinimized.setValue(this.minimized),t&&this.widgetBar.resizerBridge.exitFullscreen(),this.requestOptimalWidth(),this.activeIndex>=0&&this.pages[this.activeIndex].onActiveStateChange(!this.minimized))},O.prototype.getWidgetsButtonTitle=function(){return this.minimized?window.t("Show Widgets"):window.t("Hide Widgets")},O.prototype.changeWidgetsButtonTitle=function(){this.widgetBar.$widgetBarBtn&&this.widgetBar.$widgetBarBtn.attr("title",this.getWidgetsButtonTitle())},O.prototype.switchPage=function(t){if(-1===t||0===this.pages.length)return this.activeIndex=-1,void this.activePageIndex.setValue(this.activeIndex);var e;if(t instanceof E){if(-1===(e=this.pages.indexOf(t)))return}else e=+t;var i=this.pages[this.activeIndex];this.activeIndex=Math.min(this.pages.length-1,Math.max(0,e)),this.activePageIndex.setValue(this.activeIndex);var a=this.pages[this.activeIndex];this.activeName=a.name,this.minimized||i&&i===a||(i&&i.onActiveStateChange(!1),a&&a.onActiveStateChange(!0))},O.prototype.getActivePage=function(){return this.minimized?null:this.pages[this.activeIndex]||null},O.prototype.onTabClick=function(t,e){if(!t.isDefaultPrevented()){var i=this.pages.indexOf(e);-1!==i&&(t.preventDefault(),i!==this.activeIndex||this.minimized?(e._gaEvent&&h("Platform Widgets",e._gaEvent),this.switchPage(i),this.minimized&&this.setMinimizedState(!1)):this.setMinimizedState(!0),this.widgetBar&&this.widgetBar.saveToTVSettings())}},M.prototype.ensureSupportTicketButtonViewModel=function(){return this._supportTicketButtonViewModel?this._supportTicketButtonViewModel:this._supportTicketButtonViewModel=new v({icon:i("5qsH"),hint:window.t("Help Center"),onClick:function(){e.enabled("charting_library_base")?window.showUserReportDialog():(o.onReady("widgetbar",(function(t){var e=t.showSupportDialog;e&&e()})),o.load("widgetbar",null,0))}})},M.prototype.ensureHelpButtonViewModel=function(){if(this._helpButtonViewModel)return this._helpButtonViewModel;var t=this.ensureSupportTicketButtonViewModel();return this._helpButtonViewModel=new v({icon:i("1WEt"),hint:$.t("Help Center"),onClick:t.onClick.value()})},O.prototype.onLayoutResizeHandleMousedown=function(t){if(!t.isDefaultPrevented()){t.preventDefault();var e,i=this,a=Math.max(this.widgetBar.resizerBridge.width.value()-this.tabsWidth()-this.borderWidth(),0);e=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX,$(document.documentElement).on("mousemove touchmove",n).on("mouseup touchend",(function t(e){$(document.documentElement).off("mousemove touchmove",n).off("mouseup touchend",t),i.widgetBar&&i.widgetBar.saveToTVSettings(),i.changeWidgetsButtonTitle()}))}function n(t){var n;n=t.originalEvent.touches?t.originalEvent.touches[0].clientX:t.pageX;var s=a-(n-e)
;s<i.MINIMIZE_THRESHOLD?s=0:s<i.MIN_WIDTH&&(s=i.MIN_WIDTH),s>0&&(i.width=s),i.requestWidth(s)}},O.prototype.removePage=function(t){var e=this.pages.indexOf(t);-1!==e&&(delete t.widgetBarLayout,this.pages.splice(e,1),t.$page.detach(),t.$page.detach(),t.$tab.detach(),this.activeIndex===e&&this.switchPage(e-1))},O.prototype.createPage=function(){var t=new E({widgetBarLayout:this});return this.pages.push(t),t.createHTML(),this.$pagescontent.append(t.$page),t},O.prototype.createWidget=function(t,e){if(e){if(-1===this.pages.indexOf(e))return null}else e=this.createPage();var i=new V({widgetBarPage:e});return i.demarshal({type:t}),i.createHTML(),e.attachWidget(i),i},O.prototype.widgetInsertionDisallowed=function(t){return"watchlist"===t&&((!window.user||!user.is_pro)&&(!!this.pages.some((function(e){return e.widgets.some((function(e){return e.type===t}))}))||void 0))},O.prototype.onVisibilityChange=function(){var t=!(!this.widgetBar||!this.widgetBar.resizerBridge.visible.value());this.visible=t,this.pages.forEach((function(e){e.onVisibilityChange(t)}))},O.prototype.destroy=function(){if(this.widgetBar&&this.widgetBar.layout===this&&delete this.widgetBar.layout,this.tabRenderer&&(this.tabRenderer.destroy(),this.tabRenderer=null),this.$hider){var t=this.$hider.get(0);m.unmountComponentAtNode(t)}for(var e=this.pages.length;e--;)for(var i=this.pages[e],a=i.widgets.length;a--;)i.widgets[a].destroy();for(var n in this)this[n]instanceof $&&this[n].remove(),delete this[n]},O.prototype.getWidgetBarOption=function(){if(this.widgetBar&&name in this.widgetBar)return this.widgetBar[name]},O.prototype.MIN_WIDTH=200,O.prototype.MINIMIZE_THRESHOLD=50,O.prototype.width=290,O.prototype.minimized=!e.enabled("show_right_widgets_panel_by_default"),O.prototype.activeIndex=0,O.prototype.activeName="",O.prototype.visible=!0,E.prototype.onActiveStateChange=function(t){t=!!t,$(this.$page).toggleClass("active",!!t),this.tab.onActiveStateChange(t),t&&this.updateWidgetsHeight({skipIfHeightUnchanged:!0}),this.widgets.forEach((function(e){e.onActiveStateChange(t)}))},E.prototype.updateWidgetsHeight=function(t){if(this.$page&&this.widgetBarLayout&&this.widgetBarLayout.widgetBar)if(this.widgetBarLayout.getActivePage()===this){t=t||{};var e=this.widgetBarLayout.widgetBar.resizerBridge.height.value();if(this._pageHeight===e&&t.skipIfHeightUnchanged||(this._invalidated=!0,this._pageHeight=e),this._invalidated){for(var i,a=e,n=0,s=this.widgets,o=null,r=this.widgets.length;r--;)if(this.widgets[r].widgetMaximized.value()){o=this.widgets[r];break}if(o){for(r=this.widgets.length;r--;){(g=s[r])!==o&&g.setHeight(0)}s=[o]}for(r=s.length-1;r>0;r--){a-=(g=s[r]).widgetConfig&&g.widgetConfig.margin||1}for(r=s.length;r--;){(g=s[r]).$widget&&(void 0===i&&(i=g.$header.outerHeight(!0)),a-=i,n+=g.heightRatio)}var d=a/n,l=s.length-1;for(r=0;r<=l;r++){var h,g=s[r];h=r===l?a:Math.round(d*g.heightRatio),g.setHeight(h),a-=h}}}else this._invalidated=!0},E.prototype.onWidgetResizeHandleMousedown=function(t,e){if(!t.isDefaultPrevented()){var i,a,n,s=this;t.preventDefault()
;for(var o=this.widgets.length-1;o>0;o--)this.widgets[o]===e&&(i=this.widgets[o],a=this.widgets[o-1]);n=t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY;var r=a._rdState.bridge().height.value(),d=a.heightRatio+i.heightRatio,l=r+i._rdState.bridge().height.value();if(0!==l){var h,g=function(t){s.$page.addClass("widget-resize-mode");var e=(t.originalEvent.touches?t.originalEvent.touches[0].clientY:t.pageY)-n,o=Math.max(0,Math.min(r+e,l));h!==o&&(h=o,a.heightRatio=o/l*d,i.heightRatio=d-a.heightRatio,a.setHeight(o),i.setHeight(l-o))},c=function(t){$(document.documentElement).off("mousemove touchmove",g).off("mouseup touchend",c),s.$page.removeClass("widget-resize-mode"),h!==r&&(s.normalizeRatios(),s.widgetBarLayout&&s.widgetBarLayout.widgetBar&&s.widgetBarLayout.widgetBar.saveToTVSettings())};$(document.documentElement).on("mousemove touchmove",g).one("mouseup touchend",c)}}},E.prototype.normalizeRatios=function(){for(var t=1/0,e=this.widgets.length;e--;){var i=this.widgets[e].heightRatio;i<=0||!isFinite(i)||i<t&&(t=i)}if(isFinite(t)){for(var a=1;t<1;)t*=2,a*=2;for(;t>=2;)t/=2,a/=2;for(e=this.widgets.length;e--;)this.widgets[e].heightRatio*=a}},E.prototype.attachWidget=function(t,e){e=+e;var i=this.widgets.indexOf(t);-1!==i?this.widgets.splice(i,1):t.widgetBarPage&&t.widgetBarPage!==this&&t.widgetBarPage.removeWidget(t),e<this.widgets.length?e<0&&(e=0):e=this.widgets.length,delete t.widgetBarPage,Object.defineProperty(t,"widgetBarPage",{value:this,configurable:!0}),this.widgets.splice(e,0,t);var a=this.widgets[e+1];a?t.$widget.insertBefore(a.$widget):t.$widget.appendTo(this.$page),this.widgetBarLayout&&this.widgetBarLayout.getActivePage(),this.updateWidgetsHeight(),t.updateVisibleWatchedValue()},E.prototype.removeWidget=function(t){var e=this.widgets.indexOf(t);-1!==e&&(delete t.widgetBarPage,this.widgets.splice(e,1),t.$widget&&t.$widget.detach(),this.updateWidgetsHeight())},E.prototype.remove=function(){this.widgetBarLayout&&this.widgetBarLayout.removePage(this)},E.prototype.destroy=function(){for(var t in this.remove(),this)this[t]instanceof $&&this[t].remove(),delete this[t]},E.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},E.prototype.onVisibilityChange=function(t){var e=t&&this.widgetBarLayout&&this.widgetBarLayout.getActivePage()===this;this.widgets.forEach((function(i){e&&i.clearNotifications(),i.onVisibilityChange(t)}))},E.prototype.notify=function(t,e){!0!==(e=e||{}).clear?e.stopHighlightTab||(this.notificationCounter=this.notificationCounter+(~~t||1),this.updateNotifications(e.notificationValue)):this.clearNotifications()},E.prototype.clearNotifications=function(){this.notificationCounter=0,this.tab.updateNotifications(this.notificationCounter)},E.prototype.updateNotifications=function(t){var e="number"==typeof t?t:this.notificationCounter;this.tab.updateNotifications(e)},E.prototype.notificationCounter=0,E.prototype.getWidgets=function(t){for(var e=[],i=0;i<this.widgets.length;++i){var a=this.widgets[i]
;a.type===t&&e.push(a)}return e},V.prototype.setHeight=function(t){$(this._internalState.container.value())&&$(this._internalState.container.value()).height(t),this._internalState.height.setValue(t)},V.prototype.onWidthChange=function(t){this._internalState.width.setValue(t)},V.prototype.remove=function(){this.widgetBarPage&&this.widgetBarPage.removeWidget(this)},V.prototype.destroy=function(){for(var t in this.widgetObject&&"function"==typeof this.widgetObject.destroy&&this.widgetObject.destroy(),this.remove(),this.symbolLinking&&(this.symbolLinking.destroy(),this.symbolLinking=null),this.intervalLinking&&(this.intervalLinking.destroy(),this.intervalLinking=null),this.widgetVisible&&(this.widgetVisible.unsubscribe(),this.widgetVisible=null),this.widgetActive&&(this.widgetActive.unsubscribe(),this.widgetActive=null),this.watchedHeight&&(this.watchedHeight.unsubscribe(),this.watchedHeight=null),this.watchedWidth&&(this.watchedWidth.unsubscribe(),this.watchedWidth=null),this.widgetMaximized&&(this.widgetMaximized.unsubscribe(),this.widgetMaximized=null),this)this[t]instanceof $&&this[t].remove(),delete this[t];M._messageHandlers=M._messageHandlers.filter((function(t){return t.widget!==this}),this),clearTimeout(this._preloadTimeout)},V.prototype.onActiveStateChange=function(t){var e=(this.getWidgetBarOption("widgetConfig")||M.widgetConfig)[this.type];this.$icon&&this.$icon.toggleClass("active",!!t),t&&!e.doNotClearNotifications&&this.clearNotifications(),this.updateVisibleWatchedValue(),this.widgetActive.setValue(!!t)},V.prototype.toggleMaximize=function(t){if("boolean"!=typeof t)t=!this.widgetMaximized.value();else if(t===this.widgetMaximized.value())return;this.widgetMaximized.setValue(t),this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&this.widgetBarPage.widgetBarLayout.widgetBar.saveToTVSettings(),this.widgetBarPage&&this.widgetBarPage.updateWidgetsHeight()},V.prototype.startWidget=function(){if(!this.widgetObject&&!this.widgetStartDelayed){var t=(this.getWidgetBarOption("widgetConfig")||M.widgetConfig)[this.type];if(t){var e=t.ctor;if(e){var i=this;if(this.widgetVisible=this.widgetVisible||new a,this.updateVisibleWatchedValue(),t.lazyLoad&&!this.widgetVisible.value())return this.widgetStartDelayed=!0,this.widgetVisible.when((function(){delete i.widgetStartDelayed,i.startWidget(),clearTimeout(i._preloadTimeout)})),void(t.preloadDelay&&(this._preloadTimeout=setTimeout((function(){e.preload&&e.preload()}),t.preloadDelay)));this.symbolLinking=d.symbol.spawn(),this.intervalLinking=d.interval.spawn();var n=this._rdState.bridge(),s={$widget:this.$widget,$header:this.$header,$headerspace:this.$headerspace,$body:$(n.container.value()),header:this.$header[0],widget:this.$widget[0],container:n.container.value(),properties:this.properties,notify:this.notify.bind(this),clearNotifications:this.clearNotifications.bind(this),visible:this.widgetVisible.readonly(),active:this.widgetActive.readonly(),symbol:this.symbolLinking,interval:this.intervalLinking,height:n.height,
width:n.width,setTitle:this.setTitle.bind(this),setTitleHtml:this.setTitleHtml.bind(this),id:this.id,toggleMaximize:this.toggleMaximize.bind(this),maximized:this.widgetMaximized.readonly(),postMessage:M.postMessage.bind(this),onMessage:M.onMessage.bind(this),hideDetach:!1,unAuthEditable:this.unAuthEditable};if(t.chartWidgetAllowed){var o=function(){return i.widgetBarPage&&i.widgetBarPage.widgetBarLayout&&i.widgetBarPage.widgetBarLayout.widgetBar&&i.widgetBarPage.widgetBarLayout.widgetBar.chartWidgetCollection};s.getChartWidget=function(){var t=o();return t?t.activeChartWidget.value():null},s.getChartWidgetCollection=function(){return o()||null}}null!=this.readonly?this.readonly&&(s.readonly=!0):this.getWidgetBarOption("readonly")&&(s.readonly=!0),null!=t.options&&(s.options=t.options),null!=this.stateData?s.data=this.stateData:null!=t.data&&(s.data=t.data);var r=this.widgetObject=new e(s);r.hasLifecycle&&this.widgetActive.readonly().subscribe((function(t){t?r.mount():r.unmount()})),this._widgetStarted.fire(this)}}}},V.prototype.widgetStarted=function(){return this._widgetStarted},V.prototype.notify=function(t,e){if(e=e||{},this.widgetBarPage&&(!this.widgetBarPage.isActiveAndVisible()||e.force))return this.widgetBarPage.notify(t,e)},V.prototype.clearNotifications=function(){if(this.widgetBarPage)return this.widgetBarPage.clearNotifications()},E.prototype.isActiveAndVisible=function(){var t=this.widgetBarLayout;return!(!t||!t.visible)&&t.getActivePage()===this},V.prototype.onVisibilityChange=function(t){this.updateVisibleWatchedValue()},V.prototype.updateVisibleWatchedValue=function(){this.widgetVisible&&this.widgetVisible.setValue(!!this.widgetBarPage&&this.widgetBarPage.isActiveAndVisible())},V.prototype.setTitle=function(t){this.customTitle=t+"",this.$title&&this.$title.text(this.getTitle())},V.prototype.setTitleHtml=function(t){this.$title&&this.$title.html(t)},V.prototype.heightRatio=1,V.prototype.getWidgetBarOption=function(t){if(this.widgetBarPage&&this.widgetBarPage.widgetBarLayout&&this.widgetBarPage.widgetBarLayout.widgetBar&&t in this.widgetBarPage.widgetBarLayout.widgetBar)return this.widgetBarPage.widgetBarLayout.widgetBar[t]},H.prototype.value=function(t){return this._value},H.prototype.setValue=function(t,e){return this._value=t,this._settingsKey&&(null==t?(h("Settings debug","WigdetProperties.setValue: "+this._settingsKey,user.username),TVSettings.remove(this._settingsKey)):TVSettings.setJSON(this._settingsKey,t,e)),this._value},M.prototype.createHTML=function(){var t=this.$container;!t||t.size()<1||(t.empty(),this.layout.createHTML(),this.$wrap=$(document.createElement("div")).attr("class","widgetbar-wrap unselectable js-right-boundary").appendTo(t),this.layout.$pages.appendTo(this.$wrap),L()&&this.layout.$tabs.appendTo(this.$wrap),this.layout.$deviceButton&&this.$wrap.append(this.layout.$deviceButton),this.layout.$hider&&this.layout.$hider.appendTo(this.$wrap))},O.prototype._tabRendererOptions=function(){var t=this.widgetBar._internal;return{tabs:this.pages,
isDomButtonAvailable:t.isDomButtonAvailable(),isOrderPanelButtonAvailable:t.isOrderPanelButtonAvailable(),isSupportTicketButtonAvailable:t.isSupportTicketButtonAvailable(),isHelpButtonAvailable:t.isHelpButtonAvailable()}},O.prototype.updateRightToolbar=function(){this.tabRenderer.updateOptions(this._tabRendererOptions())},O.prototype.createHTML=function(){var t=this;if(t.$tabs=t.$tabscontent=$(),L()&&(t.$tabs=$('<div class="widgetbar-tabs">'),t.tabRenderer&&(t.tabRenderer.destroy(),t.tabRenderer=null),t.tabRenderer=new w(t.widgetBar,t.$tabs[0],t._tabRendererOptions())),t.$pages=$(document.createElement("div")).attr("class","widgetbar-pages"),t.$pagescontent=$(document.createElement("div")).attr("class","widgetbar-pagescontent").appendTo(t.$pages),L()||t.$pages.css("right","-1px"),t.$handle=$(document.createElement("div")).attr("class","widgetbar-handle").appendTo(t.$pages),t.$handle.on("mousedown touchstart",t.onLayoutResizeHandleMousedown.bind(t)),t.$handle.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-handle")&&t.preventDefault()})),this.widgetBar.showCloseButton){t.$hider=$(document.createElement("div")).addClass("widgetbar-hider");var e=function(){var e=t.$hider.get(0);e.classList.toggle("widgetbar-hider--closed",t.isMinimized.value()),e.classList.toggle("js-hidden",L()&&t.isMinimized.value()),m.render(y.createElement(f,{isMinimized:t.isMinimized.value(),onClick:function(){t.setMinimizedState(!t.minimized)}}),e)};t.isMinimized.subscribe(e),e()}t.pages.forEach((function(e){e.createHTML(),e.$page.appendTo(t.$pagescontent)}))},E.prototype.createHTML=function(){var t=this;t.$page=$(document.createElement("div")).attr("class","widgetbar-page"),t.widgets.forEach((function(e){e.createHTML(),e.$widget.appendTo(t.$page)}))},E.prototype.createTabButtonViewModel=function(){var t=this;t.tab=new v({icon:M.svgIcons[t.icon],hint:t.title,onClick:function(e){t.widgetBarLayout&&t.widgetBarLayout.onTabClick(e,t)}})},V.prototype.getTitle=function(t){var e,i,a,n=(e=this.type,i=this.getWidgetBarOption("widgetConfig"),!(a=((i=i||M.widgetConfig)[e]||0).title)&&e&&(a=(""+e).match(/[A-Z]{2,}|\d+(?:\.\d+)?|[A-Z]?[a-z]+/g).join(" ").replace(/^.|\s./g,(function(t){return t.toUpperCase()}))),a||void 0);return t&&this.customTitle&&n?this.customTitle.substr(0,n.length)===n?this.customTitle:n+": "+this.customTitle:this.customTitle||n||$.t("Widget")},V.prototype.createHTML=function(){var t=this,e=!!t.widgetConfig&&(!!t.widgetConfig.icon&&t.widgetConfig.icon),i=t.widgetConfig&&t.widgetConfig.emptyHeader,a=t.widgetConfig&&t.widgetConfig.noHeader,n=t.widgetConfig&&t.widgetConfig.noHeaderSpace,s=t.widgetConfig&&t.widgetConfig.widgetClass||"",o=t.widgetConfig&&t.widgetConfig.headerClass||"",r=t.widgetConfig&&t.widgetConfig.titleClass||"";t.$widget=$(document.createElement("div")).attr("class",u(s,"widgetbar-widget","widgetbar-widget-"+t.type)),t.$header=$(document.createElement("div")).attr("class",o||"widgetbar-widgetheader"),a||t.$header.appendTo(t.$widget),t.$header.on("contextmenu",(function(t){
"input"!==t.target.tagName.toLowerCase()&&t.preventDefault()})),e&&(t.$headericon=$(document.createElement("div")).attr("class","widgetbar-widgetheader-icon widgetbar-widgetheader-icon-"+e).append($(M.svgIcons[e])).appendTo(t.$header)),n||(t.$headerspace=$(document.createElement("div")).attr("class","widgetbar-headerspace").appendTo(t.$header),t.$headerspace.on("click",(function(t){t.preventDefault()}))),i||(t.$title=$(document.createElement("div")).attr("class",u("widgetbar-widgettitle",r)).appendTo(t.$header),t.$title.text(this.getTitle()));var d=$(document.createElement("div")).attr("class","widgetbar-widgetbody").appendTo(t.$widget);d.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-widgetbody")&&t.preventDefault()})),t._internalState.container.setValue(T(d)),t.$resizehandle=$(document.createElement("div")).attr("class","widgetbar-widgethandle").appendTo(t.$widget),t.$resizehandle.on("mousedown touchstart",(function(e){t.widgetBarPage&&t.widgetBarPage.onWidgetResizeHandleMousedown(e,t)})),t.$resizehandle.on("contextmenu",(function(t){t.target.classList.contains("widgetbar-widgethandle")&&t.preventDefault()})),!0===this.maximized&&(this.toggleMaximize(!0),delete this.maximized)},O.demarshal=function(t,e){return(new O).demarshal(t,e)},E.demarshal=function(t,e){return(new E).demarshal(t,e)},V.demarshal=function(t,e){return(new V).demarshal(t,e)},O.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(o){}if(!t||"object"!=typeof t)return null;this.width=+t.width,!isFinite(this.width)||this.width<=0?delete this.width:this.width<this.MIN_WIDTH&&(this.width=this.MIN_WIDTH),"minimized"in t?(this.minimized=!!t.minimized,this.isMinimized.setValue(this.minimized)):(delete this.minimized,this.isMinimized.setValue(this.minimized)),"version"in t&&(this.version=t.version);var i=+t.activeIndex,a=t.activeName,n=!1,s=this.pages;return s.splice(0,this.pages.length),Array.isArray(t.pages)&&t.pages.forEach((function(t,o){var r=new E({widgetBarLayout:this}).demarshal(t,e);a?t.name===a&&r&&(i=o,n=!0):r||o!==i||i--,r&&s.push(r)}),this),a&&!n&&(i=0),0===s.length?(this.activeIndex=-1,this.activePageIndex.setValue(this.activeIndex)):i>=0&&i<s.length&&(this.activeIndex=i,this.activePageIndex.setValue(this.activeIndex)),this},E.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(a){}if(!t||!t.widgets||!Array.isArray(t.widgets))return null;var i=this.widgets;return i.splice(0,i.length),this._gaEvent=t._gaEvent,this.title=t.title,this.name=t.name,this.icon=t.icon,this.spaceBottom=t.spaceBottom,this.spaceBottomText=t.spaceBottomText,this.onBottom=t.onBottom,this.createTabButtonViewModel(),t.widgets.forEach((function(t){var a=new V({widgetBarPage:this}).demarshal(t,e);a&&i.push(a)}),this),0===i.length?null:this},V.prototype.demarshal=function(t,e){if("string"==typeof t)try{t=JSON.parse(t)}catch(s){}if(!t||"object"!=typeof t)return null;var i;if("id"in t?(this.id=t.id+"",this.type=this.id.replace(/\..*/,"")):"type"in t?(this.type=t.type+"",
this.id=M.prototype.createWidgetId(this.type)):(delete this.type,delete this.id),null!=t.readonly?this.readonly=!!t.readonly:delete this.readonly,this.stateData=t.data,isFinite(+t.heightRatio)&&+t.heightRatio>=0?this.heightRatio=+t.heightRatio:delete this.heightRatio,!0===t.maximized&&(this.maximized=!0),!0===t.unAuthEditable&&(this.unAuthEditable=!0),t.settingsKey)i=t.settingsKey;else if(this.id){var a=this.getWidgetBarOption("_settingsPrefix");a&&(i=a+".widget."+this.id)}this.properties=new H({widgetBarWidget:this,settingsKey:i}),null==t.properties||i&&null!==this.properties.value()||this.properties.setValue(t.properties),"news"!==this.type&&"hotlist"!==this.type||!i||this.properties.setValue($.extend(!0,{},t.properties,this.properties.value())),"hotlist"===this.type&&!i&&t.properties&&this.properties.setValue(t.properties),this.widgetConfig=null;var n=this.getWidgetBarOption("widgetConfig");return n[this.type]&&(this.widgetConfig=n[this.type]),this},O.prototype.marshal=function(t){var e=[];this.pages.forEach((function(i){var a=i.marshal(t);a&&(e=e.concat(a))}));for(var i={},a=0;a<e.length;a++)if(e[a].type){var n=e[a].type;e[a].id&&delete e[a].type,i[n]?i[n].push(e[a]):i[n]=[e[a]]}var s={widgets:i,settings:{}};return["minimized","width","activeIndex","version","activeName"].forEach((function(t){this[t]!==O.prototype[t]&&(s.settings[t]=this[t])}),this),s},E.prototype.marshal=function(t){var e=[];return this.widgets.forEach((function(i){var a=i.marshal(t);a&&e.push(a)})),0===e.length?null:e},V.prototype.marshal=function(t){var e={};return this.id&&(e.id=this.id),this.type&&(e.type=this.type),["heightRatio"].forEach((function(t){this[t]!==V.prototype[t]&&(e[t]=this[t])}),this),this.widgetMaximized.value()&&(e.maximized=!0),t&&t.includeWidgetProperties&&this.properties&&(e.properties=TradingView.clone(this.properties.value())),e},t.exports.WidgetBar=M}).call(this,i("Kxc7"),i("hY0g"),i("aIyQ"))},"Fb/L":function(t,e,i){"use strict";i.r(e),i.d(e,"WidgetBarInternal",(function(){return n}));var a=i("Kxc7"),n=function(){function t(){}return t.prototype.isHelpButtonAvailable=function(){return!a.enabled("widget")&&!a.enabled("charting_library_base")},t.prototype.isSupportTicketButtonAvailable=function(){return a.enabled("bugreport_button")},t.prototype.isDomButtonAvailable=function(){return a.enabled("dome_widget")},t.prototype.isOrderPanelButtonAvailable=function(){return a.enabled("order_panel")},t}()},GNw3:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m5 12v-1h4v1zm5-6h1v4h-1zm0 7h1v4h-1zm2-1v-1h4v1zm7 0v-1h10.5a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5V20h1v9.5a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5H19zm-3 5a1 1 0 0 0 0 2h12a1 1 0 0 0 0-2H16zm0-1h12a2 2 0 1 1 0 4H16a2 2 0 1 1 0-4zm-1 8v-1h8v1zm0 4v-1h8v1zm11-4v-1h3v1zm0 4v-1h3v1z"/></svg>'},HSWI:function(t,e,i){t.exports={filler:"filler-3UAoz6aE"}},"If+W":function(t,e,i){t.exports={toolbar:"toolbar-1A0PjTA7",isGrayed:"isGrayed-1AzrEXYM"}},
Opoj:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 17" width="17" height="17"><path fill="none" stroke="currentColor" d="M1 1l15 15M1 16L16 1"/></svg>'},PW1O:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m17 30a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m6 5a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4 1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2 1 1 0 0 0 0-2m10 5a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2m0-7a1 1 0 0 1 0 4h-4a1 1 0 0 1 0-4m0 1a1 1 0 0 0 0 2h4a1 1 0 0 0 0-2"/></svg>'},PiKd:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isExists=function(t){return!!o(t)},e.load=function(t,e,i){if(e){var n=o(t);n?n.cb=e:a.push({m:t,cb:e})}(void 0!==i||s)&&function(t,e){"number"==typeof e?setTimeout((function(){return r(t)}),e):(!0===e||s)&&r(t)}(t,i)},e.isLoaded=function(t){var e=o(t);return e&&"loaded"===e.state},e.onReady=function(t,e){var i=o(t);n[t]=n[t]||[],n[t].push(e),i&&"loaded"===i.state&&d(t)};var a=[],n={},s=!1;function o(t){return a.filter((function(e){return e.m===t}))[0]}function r(t){var e=o(t);e&&e.cb&&$.when(e.cb()).done((function(){e.state="loaded",e.args=Array.prototype.slice.call(arguments),delete e.cb,d(e.m)}))}function d(t){var e=o(t),i=n[t];i&&function t(i){i&&!i.length||(i.shift().apply(null,e.args),t(i))}(i)}setTimeout((function(){var t;for(s=!0,t=0;t<a.length;t+=1)r(a[t].m)}),5e3)},YvYu:function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" width="45" height="45"><path fill="currentcolor" d="M16.5 21.5l8.146 8.146a.914.914 0 0 1-1.292 1.293L16.5 24.086l-6.854 6.853a.914.914 0 0 1-1.292-1.293L16.5 21.5zm0 4l6.146 6.146a1.914 1.914 0 0 0 2.708-2.707L16.5 20.086l-8.854 8.853a1.914 1.914 0 1 0 2.708 2.707L16.5 25.5zm13 0l8.146-8.146a.914.914 0 0 0-1.292-1.293L29.5 22.914l-6.854-6.853a.914.914 0 0 0-1.292 1.293L29.5 25.5zm0-4l6.146-6.146a1.914 1.914 0 0 1 2.708 2.707L29.5 26.914l-8.854-8.853a1.914 1.914 0 1 1 2.708-2.707L29.5 21.5z"/></svg>'},"aE/C":function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M22.308 8.606a.5.5 0 0 0-.616 0l-11.5 9a.5.5 0 0 0 0 .788l11.5 9a.5.5 0 0 0 .616 0l11.5-9a.5.5 0 0 0 0-.788l-11.5-9zM22 26.366L11.311 18 22 9.635 32.689 18 22 26.365zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 30.366zm0 4l-11.192-8.76-.616.788 11.5 9a.5.5 0 0 0 .616 0l11.5-9-.616-.788L22 34.366z"/></svg>'},ai7J:function(t,e,i){t.exports={separator:"separator-3EpY15lj"}},dCE3:function(t,e,i){t.exports={button:"button-ef8Q4JWf",icon:"icon-1i5UojWG"}},dECE:function(t,e){
t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45"><path fill="currentcolor" d="m29.5 11a4.5 4.5 0 0 1 4.5 4.5v14a4.5 4.5 0 0 1-4.5 4.5h-15a4.5 4.5 0 0 1-4.5-4.5v-14a4.5 4.5 0 0 1 4.5-4.5m0 1a3.5 3.5 0 0 0-3.5 3.5v14a3.5 3.5 0 0 0 3.5 3.5h15a3.5 3.5 0 0 0 3.5-3.5v-14a3.5 3.5 0 0 0-3.5-3.5M15 17v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1zm0 4v-1h14v1z"/></svg>'},dkCg:function(t,e,i){"use strict";i.r(e);var a=i("q1tI"),n=i("i8i4"),s=(i("EsMY"),i("mrSG")),o=i("17x9"),r=i("TSYQ"),d=i("Iivm"),l=i("dCE3"),h=i("Opoj");function g(t){var e=r(t.className,l.button,t.isGrayed&&l.isGrayed);return a.createElement("div",{className:e,onClick:t.onClick,"data-role":"button","data-name":t.name},a.createElement(d.Icon,{className:l.icon,icon:h}))}var c=i("5AaZ"),u=i("1Pr8");function p(t){t=Object(s.__assign)({isTab:!0,theme:u},t);var e=r(t.className,t.theme.button,t.isTab&&t.theme.isTab,t.isActive&&t.theme.isActive,t.isGrayed&&t.theme.isGrayed,t.hint&&"apply-common-tooltip common-tooltip-vertical");return a.createElement("div",{className:e,title:t.hint,onClick:t.onClick,ref:t.reference,"data-role":"button","data-name":t.name},a.createElement("div",{className:t.theme.hoverMask}),a.createElement(d.Icon,{icon:t.icon}),a.createElement("div",{className:t.theme.counterRow},a.createElement("span",{className:t.theme.counter,"data-name":"counter"},t.count)))}var w=i("vOQ2"),v=i("Eyy1"),f=i("1TxM"),m=i("PW1O"),y=window.t("DOM"),b=Object(f.b)(),_=function(t){function e(e,i){var a=t.call(this,e,i)||this;return a._handleClick=function(){(0,Object(v.ensure)(a.context.widgetBar.tradingPanelAccessor).setDomPanelVisibility)(!a.state.isActive)},a._handleIsOpenedChange=function(){a.setState({isActive:a._tradingPanel.isPageOpened(w.d.DomPanel)})},a._handleActivePageChange=function(t){a._tradingPanel.isOpened.value()&&a.setState({isActive:t===w.d.DomPanel})},Object(f.c)(i,{widgetBar:o.any.isRequired}),a._tradingPanel=Object(v.ensure)(a.context.widgetBar.tradingPanelAccessor).tradingPanel,a.state={isActive:a._tradingPanel.isPageOpened(w.d.DomPanel)},a}return Object(s.__extends)(e,t),e.prototype.componentDidMount=function(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)},e.prototype.componentWillUnmount=function(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)},e.prototype.render=function(){return a.createElement(p,Object(s.__assign)({},this.props,{icon:m,hint:y,isActive:this.state.isActive,onClick:this._handleClick}))},e.contextType=b,e}(a.PureComponent),B=i("JWMC"),C=i("YvYu"),P=window.t("Order Panel"),T=Object(f.b)(),W=function(t){function e(e,i){var a=t.call(this,e,i)||this;return a._handleClick=function(){var t=Object(v.ensure)(a.context.widgetBar.tradingPanelAccessor).setOrderPanelVisibility,e=!a.state.isActive;t(e),e&&Object(B.trackEvent)("GUI","Open Order Panel")},a._handleIsOpenedChange=function(){a.setState({
isActive:a._tradingPanel.isPageOpened(w.d.OrderPanel)})},a._handleActivePageChange=function(t){a._tradingPanel.isOpened.value()&&a.setState({isActive:t===w.d.OrderPanel})},Object(f.c)(i,{widgetBar:o.any.isRequired}),a._tradingPanel=Object(v.ensure)(a.context.widgetBar.tradingPanelAccessor).tradingPanel,a.state={isActive:a._tradingPanel.isPageOpened(w.d.OrderPanel)},a}return Object(s.__extends)(e,t),e.prototype.componentDidMount=function(){this._tradingPanel.isOpened.subscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.subscribe(this._handleActivePageChange)},e.prototype.componentWillUnmount=function(){this._tradingPanel.isOpened.unsubscribe(this._handleIsOpenedChange),this._tradingPanel.activePage.unsubscribe(this._handleActivePageChange)},e.prototype.render=function(){return a.createElement(p,Object(s.__assign)({},this.props,{icon:C,hint:P,isActive:this.state.isActive,onClick:this._handleClick}))},e.contextType=T,e}(a.PureComponent),S=i("ai7J");function $(t){return a.createElement("div",{className:r(t.className,S.separator)})}var x=i("HSWI");function z(t){return a.createElement("div",{className:r(x.filler,t.className)})}function M(t,e){return function(i){function n(t){var a=i.call(this,t)||this;return a._bindedForceUpdate=function(){return a.forceUpdate()},a.state={viewModel:e},a}return Object(s.__extends)(n,i),n.prototype.componentDidMount=function(){var t=this.state.viewModel;t.notificationsCount.subscribe(this._bindedForceUpdate),t.isActive.subscribe(this._bindedForceUpdate)},n.prototype.componentWillUnmount=function(){var t=this.state.viewModel;t.notificationsCount.unsubscribe(this._bindedForceUpdate),t.isActive.unsubscribe(this._bindedForceUpdate)},n.prototype.render=function(){var e=this.state.viewModel,i=e.notificationsCount.value();return a.createElement(t,Object(s.__assign)({},this.props,{icon:e.icon.value(),isActive:e.isActive.value(),onClick:e.onClick.value(),hint:e.hint.value(),count:0!==i?i.toString():void 0}))},n}(a.PureComponent)}var A=i("XAms"),O=i("txPx"),E=i("8d0Q"),V=i("If+W"),H=Object(O.getLogger)("Platform.GUI.RightToolbar"),L=Object(f.b)(),N=function(t){function e(e,i){var a,n=t.call(this,e,i)||this;n._pages={},n._isTradingPanelCanBeShown=null,n._tradingActivePage=null,n._isTradingPanelOpened=null,n._handleMouseOver=function(t){Object(E.a)(t)&&n.setState({isHovered:!0})},n._handleMouseOut=function(t){Object(E.a)(t)&&n.setState({isHovered:!1})},n._handleFullscreenChange=function(t){n.setState({isFullscreen:t})},n._handleCloseClick=function(){n.context.widgetBar.layout.setMinimizedState(!0)},n._handleGrayedChange=function(){n.setState({isGrayed:n._isGrayed()})},n._handleDomButtonVisibilityChange=function(t){n.setState({isTradingButtonsVisible:t})},n._handleActivePageChange=function(){var t;n.setState({activePageName:null===(t=n.context.widgetBar.layout.getActivePage())||void 0===t?void 0:t.name})},n._isGrayed=function(){var t=n._isMinimized.value();return null!==n._isTradingPanelOpened&&(t=t&&!n._isTradingPanelOpened.value()),!t},Object(f.c)(i,{widgetBar:o.any.isRequired})
;var r=n.context.widgetBar;if(n._isMinimized=r.layout.isMinimized.spawn(),n._isFullscreen=r.resizerBridge.fullscreen.spawn(),n._activePageIndex=r.layout.activePageIndex.spawn(),r.tradingPanelAccessor){var d=r.tradingPanelAccessor.tradingPanel;n._isTradingPanelCanBeShown=d.isAvailable.spawn(),n._tradingActivePage=d.activePage.spawn(),n._isTradingPanelOpened=d.isOpened.spawn()}return n.state={isHovered:!1,isGrayed:n._isGrayed(),isFullscreen:n._isFullscreen.value(),isTradingButtonsVisible:!1,activePageName:null===(a=r.layout.getActivePage())||void 0===a?void 0:a.name},n._isTradingPanelCanBeShown&&(n.state=Object(s.__assign)(Object(s.__assign)({},n.state),{isTradingButtonsVisible:n._isTradingPanelCanBeShown.value()})),r.layout.pages.forEach((function(t){void 0===t.name&&H.logWarn('Page does not provide required field "name"'),n._pages[t.name]=M(p,t.tab)})),n._toolset=n._createToolset(),n}return Object(s.__extends)(e,t),e.prototype.componentDidMount=function(){this._isFullscreen.subscribe(this._handleFullscreenChange),this._isMinimized.subscribe(this._handleGrayedChange),this._activePageIndex.subscribe(this._handleActivePageChange),null!==this._isTradingPanelCanBeShown&&this._isTradingPanelCanBeShown.subscribe(this._handleDomButtonVisibilityChange),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.subscribe(this._handleGrayedChange)},e.prototype.componentWillUnmount=function(){this._isFullscreen.destroy(),this._isMinimized.destroy(),this._activePageIndex.destroy(),null!==this._isTradingPanelCanBeShown&&this._isTradingPanelCanBeShown.destroy(),null!==this._tradingActivePage&&this._tradingActivePage.destroy(),null!==this._isTradingPanelOpened&&this._isTradingPanelOpened.destroy()},e.prototype.render=function(){var t=this.props,e=t.className,i=t.isDomButtonAvailable,n=t.isOrderPanelButtonAvailable,s=this.state,o=s.isHovered,d=s.isGrayed,l=s.isFullscreen,h=s.isTradingButtonsVisible,u=(s.activePageName,this.context.widgetBar),p=this._toolset,w=n&&h,v=i&&h,f=Boolean(!1);return a.createElement(c.a,{isVisibleFade:Modernizr.mobiletouch,isVisibleButtons:!Modernizr.mobiletouch&&o,isVisibleScrollbar:!1,onMouseOver:this._handleMouseOver,onMouseOut:this._handleMouseOut},a.createElement("div",{className:r(e,V.toolbar,d&&V.isGrayed),"data-name":"right-toolbar",onContextMenu:A.a},u.adaptive&&l&&a.createElement(g,{name:"close-button",onClick:this._handleCloseClick}),this._renderPages(),f&&a.createElement(a.Suspense,{fallback:null},a.createElement(NewsTabHintLazy,{isMobile:u.adaptive&&l})),(w||v)&&a.createElement($,null),w&&a.createElement(W,{name:"order-panel-button",isGrayed:d}),v&&a.createElement(_,{name:"dom-button",isGrayed:d}),a.createElement(z,null),this._renderPages(!0),p.SupportTicketButton&&a.createElement(p.SupportTicketButton,{name:"bug-report-button",isGrayed:d,isTab:!1}),p.HelpButton&&a.createElement(p.HelpButton,{name:"help-button",isGrayed:d,isTab:!1})))},e.prototype._renderPages=function(t){var e=this,i=[],n=this.state.isGrayed;return this.context.widgetBar.layout.pages.forEach((function(s){
if(s.name in e._pages&&Boolean(s.onBottom)===Boolean(t)){var o=e._pages[s.name];i.push(a.createElement(o,{name:s.name,isGrayed:n,key:s.name})),s.spaceBottom&&i.push(a.createElement($,{key:s.spaceBottomText}))}})),i},e.prototype._createToolset=function(){var t=this.context.widgetBar;return{SupportTicketButton:this.props.isSupportTicketButtonAvailable?M(p,t.ensureSupportTicketButtonViewModel()):void 0,HelpButton:this.props.isHelpButtonAvailable?M(p,t.ensureHelpButtonViewModel()):void 0}},e.contextType=L,e}(a.PureComponent),I={widgetBar:o.any},k=function(t){function e(e){var i=t.call(this,e)||this;return i._registry={widgetBar:i.props.widgetBar},i}return Object(s.__extends)(e,t),e.prototype.render=function(){return a.createElement(f.a,{validation:I,value:this._registry},this.props.children)},e}(a.PureComponent);i.d(e,"RightToolbarRenderer",(function(){return D}));var D=function(){function t(t,e,i){this._widgetBar=t,this._container=e,this._options=i,this._render()}return t.prototype.updateOptions=function(t){this._options=t,this._render()},t.prototype.destroy=function(){n.unmountComponentAtNode(this._container)},t.prototype._render=function(){n.render(a.createElement(k,{widgetBar:this._widgetBar},a.createElement(N,{isDomButtonAvailable:this._options.isDomButtonAvailable,isOrderPanelButtonAvailable:this._options.isOrderPanelButtonAvailable,isHelpButtonAvailable:this._options.isHelpButtonAvailable,isSupportTicketButtonAvailable:this._options.isSupportTicketButtonAvailable})),this._container)},t}()},e9Yb:function(t,e,i){},jkvV:function(t,e,i){"use strict";i.r(e),i.d(e,"Hider",(function(){return d}));i("YFKU");var a=i("q1tI"),n=i("TSYQ"),s=i("EKk7"),o=window.t("Hide Tab"),r=window.t("Open Tab");function d(t){var e=n(t.className,"apply-common-tooltip","common-tooltip-vertical","common-tooltip-otl");return a.createElement("div",{className:e,onClick:t.onClick,title:t.isMinimized?r:o},a.createElement(s.b,{direction:t.isMinimized?"left":"right"}))}},tBUM:function(t,e,i){"use strict";i.r(e),i.d(e,"WidgetBarTabButtonViewModel",(function(){return r}));var a=i("mrSG"),n=i("hY0g"),s=i.n(n),o={isActive:!1,notificationCount:0},r=function(){function t(t){var e=Object(a.__assign)(Object(a.__assign)({},o),t);this.isActive=new s.a(e.isActive),this.notificationsCount=new s.a(e.notificationCount),this.icon=new s.a(e.icon),this.hint=new s.a(e.hint),this.onClick=new s.a(e.onClick)}return t.prototype.onActiveStateChange=function(t){this.isActive.setValue(t)},t.prototype.updateNotifications=function(t){this.notificationsCount.setValue(t)},t}()},vOQ2:function(t,e,i){"use strict";var a;i.d(e,"d",(function(){return a})),i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return o})),function(t){t.DomPanel="domPanel",t.OrderPanel="orderPanel"}(a||(a={}));var n=400,s=296,o=451},xrkQ:function(t,e,i){t.exports={"css-value-widgets-margin":"4px",widget:"widget-1UXejvkz",widgetHeader:"widgetHeader-isab_3SI",widgetTitle:"widgetTitle-1hslJhCT",headerSpace:"headerSpace-TYG7bb1s"}}}]);
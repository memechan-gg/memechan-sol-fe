(window.webpackJsonp=window.webpackJsonp||[]).push([["source-properties-editor"],{CbZh:function(e,t,n){"use strict";n.r(t);n("YFKU");var o=n("q1tI"),i=n.n(o),a=n("i8i4"),r=n("FQhm"),l=n("mrSG"),s=n("Eyy1"),c=(n("bSeV"),n("qFKp")),u=n("Vdly"),d=n.n(u),m=n("ycFu"),p=n("tWVy"),f=n("aDg1"),h=n("/MKj"),_=n("Iivm"),g=n("oNDq"),b=n("H172"),v=n("/KDZ"),y=(n("EsMY"),n("N5tr")),w=n("i/MG"),C=n("8d0Q"),T=n("lpmA");function P(e){var t=e.name,n=e.onRemove,i=e.onClick,a=Object(C.b)(),r=a[0],s=a[1],c=o.useCallback((function(){return i(t)}),[i,t]),u=o.useCallback((function(){n&&n(t)}),[n,t]);return o.createElement("div",Object(l.__assign)({},s),o.createElement(y.b,{className:T.defaultsButtonItem,isActive:!1,label:t,onClick:c,toolbox:n&&o.createElement(w.a,{hidden:!Modernizr.mobiletouch&&!r,onClick:u})}))}var I=n("KKsp"),S=n("UJLt"),E=n("hkLy"),D=n("+EG+"),x=n("CLNU"),A=n("HWhk");var O=n("/yp2"),B=Object(h.connect)((function(e,t){var n=t.source.toolname;return{templates:e.templates[n]}}),(function(e){return{getTemplates:function(t){return e(Object(O.getTemplates)(t))},loadTemplate:function(t,n,o){e(Object(O.loadTemplate)(n.toolname,o,(function(e){return t.applyLineToolTemplate(n,e,window.t("Apply Drawing Template"))})))},removeTemplate:function(t,n){return e(Object(O.startRemoveTemplate)(t,n))},saveTemplate:function(t,n,o){return e(Object(O.saveTemplate)(t,n,o))},applyDefaults:function(t,n){return e(Object(O.applyDefaults)(t,n))}}}))((function(e){var t=e.model,n=e.source,a=e.getTemplates,r=n.toolname;Object(o.useEffect)((function(){return e.templates||a(r),function(){}}),[r]);var s=Object(o.useContext)(D.b);return i.a.createElement(v.a,{rule:"screen and (max-width: 768px)"},(function(e){return i.a.createElement(b.a,{className:!e&&T.themesButtonText,items:c(e),hideArrowButton:e,value:"defaults"})}));function c(t){var n=e.templates,o=void 0===n?[]:n,a=[u(t),{readonly:!0,content:i.a.createElement(P,{onClick:f,name:window.t("Save As...")})},{readonly:!0,content:i.a.createElement(P,{onClick:d,name:window.t("Apply Defaults")})}];return o.length>0&&a.push.apply(a,Object(l.__spreadArrays)([{readonly:!0,content:i.a.createElement(I.a,null)}],o.map((function(e){return{readonly:!0,content:i.a.createElement(P,{name:e,onRemove:m,onClick:p})}})))),a}function u(e){return{value:"defaults",readonly:!0,content:"",selectedContent:e?i.a.createElement(_.Icon,{className:T.themesButtonIcon,icon:A}):window.t("Template")}}function d(){(0,e.applyDefaults)(t,n)}function m(t){var n=e.removeTemplate;window.runOrSignIn((function(){var e=window.t("Do you really want to delete Drawing Template '{0}' ?").format(t);Object(g.createConfirmDialog)({type:"modal",content:document.createTextNode(e),manager:s||void 0}).then((function(e){e.on("action:yes",(function(e){n(r,t),e.close()})),e.open()}))}),{source:"Delete line tool template"})}function p(o){(0,e.loadTemplate)(t,n,o)}function f(){var t=e.templates,n=void 0===t?[]:t,o=function(e){return Object(x.clean)(e.template_name)},i=new S.SaveRenameDialog({fields:[new E.InputField({name:"template_name",
label:window.t("Template name")+":",maxLength:64,error:window.t("Please enter template name")})],title:window.t("Save Drawing Template As"),confirm:{shouldShowDialog:function(e){return-1!==n.indexOf(o(e))},getMessage:function(e){return window.t("Drawing Template '{0}' already exists. Do you really want to replace it?").format(o(e))}},manager:s||void 0});window.runOrSignIn((function(){i.show().then((function(t){var n=JSON.stringify(e.source.template());e.saveTemplate(r,t.template_name,n)}))}),{source:"Save line tool template",sourceMeta:"Chart"})}}));var j=n("LC+v");function k(e){var t=e.model,n=e.source;return i.a.createElement(v.a,{rule:"screen and (max-width: 768px)"},(function(e){return i.a.createElement(b.a,{className:!e&&T.themesButtonText,items:[{value:"defaults",readonly:!0,content:"",selectedContent:e?i.a.createElement(_.Icon,{className:T.themesButtonIcon,icon:A}):window.t("Template")},{readonly:!0,content:i.a.createElement(P,{onClick:o,name:window.t("Apply Defaults")})}],hideArrowButton:e,value:"defaults"})}));function o(){t.restorePropertiesForSource(n)}}function R(e){return Object(c.onWidget)()?i.a.createElement(k,Object(l.__assign)({},e)):i.a.createElement(h.Provider,{store:j.store},i.a.createElement(B,Object(l.__assign)({},e)))}var N,K,L=n("tmL0"),V=n("CW80"),q=n("vHME"),F=n("3ClC"),W=n("qJq3"),M=n("Ss5c"),z=n("GVHu"),J=n("ybVX"),H=((N={})["Elliott Impulse Wave (12345)Degree"]="normal",N["Elliott Triangle Wave (ABCDE)Degree"]="normal",N["Elliott Triple Combo Wave (WXYXZ)Degree"]="normal",N["Elliott Correction Wave (ABC)Degree"]="normal",N["Elliott Double Combo Wave (WXY)Degree"]="normal",N.BarsPatternMode="normal",N.StudyInputSource="normal",N),U=((K={}).TextText="big",K.AnchoredTextText="big",K.NoteText="big",K.AnchoredNoteText="big",K.CalloutText="big",K.BalloonText="big",K),X=n("Q+1u"),Y=n("bvfV");function Z(e){return o.createElement(J.a.Provider,{value:U},o.createElement(J.b.Provider,{value:H},e.page&&o.createElement(X.a,{reference:e.pageRef,key:e.tableKey},e.page.definitions.value().map((function(e){return o.createElement(Y.a,{key:e.id,definition:e})})))))}var G=n("ttKw"),Q=function(e){function t(t){var n=e.call(this,t)||this;n._activePageRef=o.createRef(),n._getActionPageById=function(e){if(e)return n.props.pages.find((function(t){return t.id.toLowerCase()===e.toLowerCase()}))},n._onChangeActivePageDefinitions=function(){n.setState({tableKey:Date.now()},(function(){n._requestResize&&n._requestResize()}))},n._renderFooterLeft=function(){var e=n.props,t=e.source,i=e.model;return Object(V.isLineTool)(t)?o.createElement(R,{source:t,model:i}):o.createElement(v.a,{rule:"screen and (max-width: 419px)"},(function(e){return Object(F.isStudy)(t)&&o.createElement(q.a,{model:i,source:t,mode:e?"compact":"normal"})}))},n._subscribe=function(e){e&&e.definitions.subscribe(n._onChangeActivePageDefinitions)},n._unsubscribe=function(e){e&&e.definitions.unsubscribe(n._onChangeActivePageDefinitions)},n._getActiveTabSettingsName=function(){var e=n.props.source
;return e instanceof W.Series?"properties_dialog.active_tab.chart":e instanceof M.LineDataSource?"properties_dialog.active_tab.drawing":e instanceof z.Study?"properties_dialog.active_tab.study":""},n._handleSelectPage=function(e){var t=n.state.activePageId,o=n._getActionPageById(t),i=n._getActionPageById(e),a=n._getActiveTabSettingsName();t!==e&&(n._unsubscribe(o),a&&d.a.setValue(a,e),n._subscribe(i),n.setState({activePageId:e,tableKey:Date.now()},(function(){n._requestResize&&n._requestResize(),n._focusActivePageFirstTextInput()})))},n._handleScroll=function(){p.a.fire()},n._handleSubmit=function(){n.props.onSubmit(),n._closePopupDialog()},n._closePopupDialog=function(){window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.refresh(),n.props.onClose()};var i,a=n.props.pages;if(n._getActionPageById(n.props.activePageId))i=Object(s.ensureDefined)(n.props.activePageId);else{var r=d.a.getValue(n._getActiveTabSettingsName(),""),l=n._getActionPageById(r);i=l?l.id:a[0].id}return n.state={activePageId:i,tableKey:Date.now()},window.lineToolPropertiesToolbar&&window.lineToolPropertiesToolbar.hide(),n}return Object(l.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.state.activePageId,t=this._getActionPageById(e);this._focusActivePageFirstTextInput(),this._subscribe(t)},t.prototype.componentWillUnmount=function(){var e=this.props.activePageId,t=this._getActionPageById(e);clearTimeout(this._timeout),this._unsubscribe(t)},t.prototype.render=function(){var e,t=this.props,n=t.source,i=t.onCancel,a=this.state.activePageId,r=(null===(e=n.properties().title)||void 0===e?void 0:e.value())||n.title();return o.createElement(m.a,{dataName:"source-properties-editor",title:r,isOpened:!0,onSubmit:this._handleSubmit,onCancel:i,onClickOutside:this._handleSubmit,onClose:this._closePopupDialog,footerLeftRenderer:this._renderFooterLeft,render:this._renderChildren(a),submitOnEnterKey:!1})},t.prototype._renderChildren=function(e){var t=this;return function(n){var i=n.requestResize;t._requestResize=i;var a=t.props.pages,r={allIds:a.map((function(e){return e.id})),byId:a.reduce((function(e,t){var n;return Object(l.__assign)(Object(l.__assign)({},e),((n={})[t.id]={title:t.title},n))}),{})},s=a.find((function(t){return t.id===e}));return o.createElement(o.Fragment,null,o.createElement(f.a,{activeTabId:e,onSelect:t._handleSelectPage,tabs:r}),o.createElement(L.a,{className:G.scrollable,onScroll:t._handleScroll},o.createElement(Z,{page:s,pageRef:t._activePageRef,tableKey:t.state.tableKey})))}},t.prototype._focusActivePageFirstTextInput=function(){if(!c.CheckMobile.any()&&this._activePageRef.current){var e=this._activePageRef.current.querySelector("input[type=text],textarea");e&&(this._timeout=setTimeout((function(){e.focus()}),0))}},t}(o.PureComponent);n.d(t,"SourcePropertiesEditorRenderer",(function(){return $}));var $=function(){function e(e){var t=this;this._container=document.createElement("div"),this._isVisible=!1,this._timeout=null,this._handleClose=function(){a.unmountComponentAtNode(t._container),t._isVisible=!1,
t._onClose&&t._onClose(),t._subscription.unsubscribe(t,t._handleCollectionChanged)},this._handleSubmit=function(){var e=t._source;Object(V.isLineTool)(e)&&e.hasAlert.value()&&setTimeout((function(){e.localAndServerAlertsMismatch&&e.synchronizeAlert(!0)}))},this._handleCancel=function(){t._model.undoToCheckpoint(t._checkpoint)},this._propertyPages=e.propertyPages,this._model=e.model,this._activePageId=e.activePageId,this._onClose=e.onClose,this._source=e.source,this._checkpoint=this._ensureCheckpoint(e.undoCheckPoint),this._subscription=this._model.model().dataSourceCollectionChanged(),this._subscription.subscribe(this,this._handleCollectionChanged)}return e.prototype.hide=function(e){e?this._handleCancel():this._handleSubmit(),this._handleClose()},e.prototype.isVisible=function(){return this._isVisible},e.prototype.focusOnText=function(){},e.prototype.show=function(){a.render(o.createElement(Q,{source:this._source,onSubmit:this._handleSubmit,onClose:this._handleClose,onCancel:this._handleCancel,pages:this._propertyPages,model:this._model,activePageId:this._activePageId}),this._container),this._isVisible=!0,r.emit("drawings_settings_dialog",{objectType:"drawing",scriptTitle:this._source.title()})},e.prototype._handleCollectionChanged=function(){var e=this;null===this._timeout&&(this._timeout=setTimeout((function(){e._closeDialogIfSourceIsDeleted(),e._timeout=null})))},e.prototype._closeDialogIfSourceIsDeleted=function(){null===this._model.model().dataSourceForId(this._source.id())&&this._handleClose()},e.prototype._ensureCheckpoint=function(e){return void 0===e&&(e=this._model.createUndoCheckpoint()),e},e}()},lpmA:function(e,t,n){e.exports={themesButtonText:"themesButtonText-2XRZOVS_",themesButtonIcon:"themesButtonIcon-37H2TIZ0",defaultsButtonText:"defaultsButtonText-3NI8VPPT",defaultsButtonItem:"defaultsButtonItem-3mtq1Y8x"}},ttKw:function(e,t,n){e.exports={scrollable:"scrollable-1DxdJw53"}}}]);